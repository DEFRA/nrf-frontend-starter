{% extends 'layouts/edp-form.njk' %}

{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/select/macro.njk" import govukSelect %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% set backLink = { href: "/edp-calculator/location" } %}

{% set progressSteps = [
  { text: "Location", complete: true },
  { text: "EDP check", complete: true },
  { text: "Development details", active: true },
  { text: "Review quote" },
  { text: "Payment" }
] %}

{% set helpContent = {
  title: "Environmental levy",
  content: '
    <p class="govuk-body-s">The environmental levy is calculated based on:</p>
    <ul class="govuk-list govuk-list--bullet govuk-body-s">
      <li>Number of housing units</li>
      <li>Location within EDP boundaries</li>
      <li>Development type</li>
      <li>Environmental impact factors</li>
    </ul>
  '
} %}

{% block formContent %}
      {% include 'partials/error-summary.njk' %}

      <h1 class="govuk-heading-l">{{ heading }}</h1>

      <p class="govuk-body">
        Provide details about your development to calculate the environmental levy.
      </p>

      <form method="POST" novalidate>
        <input type="hidden" name="crumb" value="{{ crumb }}">

        {{ govukInput({
          label: {
            text: "Development name",
            classes: "govuk-label--m"
          },
          hint: {
            text: "For example, Riverside Housing Development"
          },
          id: "developmentName",
          name: "developmentName",
          value: details.developmentName,
          errorMessage: fieldErrors.developmentName if fieldErrors else null
        }) }}

        {{ govukInput({
          label: {
            text: "Number of houses",
            classes: "govuk-label--m"
          },
          hint: {
            text: "Enter the total number of residential units"
          },
          id: "housesCount",
          name: "housesCount",
          value: details.housesCount,
          classes: "govuk-input--width-5",
          inputmode: "numeric",
          pattern: "[0-9]*",
          errorMessage: fieldErrors.housesCount if fieldErrors else null
        }) }}

        {{ govukSelect({
          id: "developmentType",
          name: "developmentType",
          errorMessage: fieldErrors.developmentType if fieldErrors else null,
          label: {
            text: "Development type",
            classes: "govuk-label--m"
          },
          hint: {
            text: "Select the primary type of development"
          },
          items: [
            {
              value: "",
              text: "Select a type",
              selected: not details.developmentType
            },
            {
              value: "detached",
              text: "Detached houses",
              selected: details.developmentType == "detached"
            },
            {
              value: "semi-detached",
              text: "Semi-detached houses",
              selected: details.developmentType == "semi-detached"
            },
            {
              value: "terraced",
              text: "Terraced houses",
              selected: details.developmentType == "terraced"
            },
            {
              value: "flats",
              text: "Flats/Apartments",
              selected: details.developmentType == "flats"
            },
            {
              value: "mixed",
              text: "Mixed development",
              selected: details.developmentType == "mixed"
            }
          ]
        }) }}

        {{ govukSelect({
          id: "wastewaterSite",
          name: "wastewaterSite",
          errorMessage: fieldErrors.wastewaterSite if fieldErrors else null,
          label: {
            text: "Wastewater treatment site",
            classes: "govuk-label--m"
          },
          hint: {
            text: "Select the wastewater treatment facility for your development"
          },
          items: [
            {
              value: "",
              text: "Select a site",
              selected: not details.wastewaterSite
            },
            {
              value: "site1",
              text: "North Regional Treatment Works",
              selected: details.wastewaterSite == "site1"
            },
            {
              value: "site2",
              text: "South Regional Treatment Works",
              selected: details.wastewaterSite == "site2"
            },
            {
              value: "site3",
              text: "East Regional Treatment Works",
              selected: details.wastewaterSite == "site3"
            },
            {
              value: "site4",
              text: "West Regional Treatment Works",
              selected: details.wastewaterSite == "site4"
            }
          ]
        }) }}

        <div class="govuk-button-group">
          {{ govukButton({
            text: "Continue",
            type: "submit"
          }) }}
        </div>
      </form>
{% endblock %}